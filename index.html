<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>هم‌بست آب-انرژی-محیط زیست آبخوان</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/leaflet.css" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/leaflet.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.0/papaparse.min.js"></script>
    <script src="https://unpkg.com/shpjs@latest/dist/shp.js"></script>
    <style>
        @keyframes flash {
            0% { opacity: 1; }
            50% { opacity: 0.1; }
            100% { opacity: 1; }
        }
        .flashing-marker { animation: flash 1s infinite; }
        #map { width: 100%; height: calc(100vh - 100px); } /* تنظیم ارتفاع نقشه */
        .triangle-marker {
            width: 0; height: 0;
            border-left: 7px solid transparent;
            border-right: 7px solid transparent;
            position: absolute; transform: translate(-50%, -50%);
            z-index: 0;
        }
        .marker-circle {
            width: 6px; height: 6px;
            border-radius: 50%; background-color: blue;
            position: absolute; transform: translate(-50%, -50%);
            z-index: 1;
        }
        .flashing-circle { animation: flash 1s infinite; }
        #search-container { margin: 10px; padding: 5px; }
        #well-id-search {
            width: 250px; height: 30px;
            padding: 5px; font-size: 16px;
            border-radius: 5px; border: 1px solid #ccc;
            margin-right: 10px;
        }
        #search-container button {
            height: 40px; padding: 0 15px;
            font-size: 16px; background-color: #4CAF50;
            color: white; border: none;
            border-radius: 5px; cursor: pointer;
            margin-right: 5px;
        }
        #search-container button:hover { background-color: #45a049; }
        #logo {
            position: absolute; /* تغییر به absolute */
            bottom: 20px; right: 10px;
            width: 150px; height: auto;
            z-index: 1000;
        }
        .legend {
            line-height: 18px; bottom: 20px;
            color: #555; background-color: white;
            padding: 6px 8px; border-radius: 5px;
        }
        .legend i {
            width: 14px; height: 14px;
            float: left; margin-right: 8px;
            opacity: 0.9;
        }
    </style>
</head>
<body>
    <div id="search-container">
        <input type="text" id="well-id-search" placeholder="برای جستجوی چاه، کلاسه را وارد نمائید" />
        <button onclick="searchWell()">جستجو</button>
        <button onclick="clearSearch()">پاک کردن</button>
    </div>
    <div id="map"></div>
    <img id="logo" src="images/waterCo_university.png" alt="Logo" />
    
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            var mapTilerKey = 'otxQEa1xT4DzKWLSdyS7';
            var map = L.map('map', { center: [31.052, 53.2621], zoom: 11 });
            
            var osmLayer = L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                maxZoom: 19,
                attribution: 'Developer: MH Bagheri '
            }).addTo(map);
            
            var mapTilerSatLayer = L.tileLayer('https://api.maptiler.com/maps/hybrid/{z}/{x}/{y}.jpg?key=' + mapTilerKey, {
                tileSize: 512,
                zoomOffset: -1,
                minZoom: 1,
                maxZoom: 19,
                attribution: 'Developer: MH Bagheri ',
                crossOrigin:true
            });
            
            var baseLayers = { "OSM": osmLayer, "Satellite": mapTilerSatLayer };
            L.control.layers(baseLayers).addTo(map);
            
            // اضافه کردن مقیاس
            L.control.scale({imperial:false}).addTo(map);
            
            // بارگذاری و نمایش Shapefile آکیفر
            shp("shape_files/Aquifer_.zip").then(function(geojson) {
                var aquiferLayer = L.geoJSON(geojson, {
                    style:function(feature) {
                        return { fillColor:'blue', weight:'2', opacity:'0.3', color:'blue', fillOpacity:'0.3' };
                    }
                }).addTo(map);
                
                // اضافه کردن لایه آکیفر به کنترل لایه‌ها
                baseLayers["Aquifer"] = aquiferLayer;
                L.control.layers(baseLayers).addTo(map);
                
            }).catch(function(error) {
                console.error("Error loading Shapefile:", error);
            });

             // ادامه کد...
             
             window.searchWell = function() {
                 // تابع جستجو
             };

             window.clearSearch = function() {
                 // تابع پاک کردن جستجو
             };
             
             document.getElementById("well-id-search").addEventListener("keyup", function(event) {
                 if (event.key === "Enter") { searchWell(); }
             });
         });
     </script>
</body>
</html>
